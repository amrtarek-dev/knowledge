## Telemetry
Is the collection and transmission of data for analysis.

Logs record events occurring on systems, telemetry describe the data itself.

ex: packet captures are considered network telemetry.

## IDS
Intrusion detection systems is an application that monitors activity and alerts on possible intrusions.

- Endpoint: any device connected on a network

## Host-based intrusion detection system (HIDS)
An application that monitors the activity of the host on which it's installed.
To monitor the endpoints for treats or attacks.

In addition to monitoring inbound and outbound traffic flows, HIDS can have additional capabilities, such as monitoring file systems, system resource usage, user activity, and more.

## Network-based intrusion detection system (NIDS)
An application that collects and monitors network traffic and network data.

Rule language differs depending on different intrusion detection systems.
NIDS rules consists of three components:
- Action: action to take if the rule criteria is met
	- Alert, Pass, Reject
- Header: defines the signature's network traffic
	- Source, destination IP addresses and ports, protocols, and traffic direction.
- rule options: to customize signatures with additional parameters
	- match the content of a network packet, detect malicious payloads.

Suricata Signatures example
``` bash
# custom rules example for http connection

alert http $HOOME_NET any -> $EXTERNAL_NET ANY (MSG:"GET On wire"; flow:established; content:"GET"; sid:12345; rev:1;)
```


Network telemetry refers to the collection and transmission of network data for analysis, such as HTTP traffic. 

Signature-based refers to a type of detection method that is used to find events of interest using signatures.


Suricata logs
EVE JSON: Extensible Event Format Javascript Object Notation
Generate 2 types of logs:
- Alert logs: contain information that relevant to security investigation.
- Network telemetry logs: Recording what is happening on the network.
## Detection techniques
IDS uses different types of detection methods:
### signature analysis
**Signature analysis**, or signature-based analysis, is a detection method that is used to find events of interest. A **signature** is a pattern that is associated with malicious activity. Signatures can contain specific patterns like a sequence of binary numbers, bytes, or even specific data like an IP address.
-  IDS Logs
Before alerts are generated, the activity must be logged. 
IDS technologies record the information of the devices, systems, and networks which they monitor as IDS logs.
IDS logs can then be sent, stored, and analyzed in a centralized log repository like a SIEM. 

Pyramid of Pain, which is a concept that prioritizes the different types of **indicators of compromise** (IoCs) associated with an attack or threat, such as IP addresses, tools, tactics, techniques, and more. IoCs and other indicators of attack can be useful for creating targeted signatures to detect and block attacks.
#### **Advantages**
- **Low rate of false positives:** Signature-based analysis is very efficient at detecting known threats because it is simply comparing activity to signatures. This leads to fewer false positives. Remember that a **false positive** is an alert that incorrectly detects the presence of a threat.

#### **Disadvantages**
- **Signatures can be evaded:** Signatures are unique, and attackers can modify their attack behaviors to bypass the signatures. For example, attackers can make slight modifications to malware code to alter its signature and avoid detection.
- **Signatures require updates:** Signature-based analysis relies on a database of signatures to detect threats. Each time a new exploit or attack is discovered, new signatures must be created and added to the signature database.
- **Inability to detect unknown threats:** Signature-based analysis relies on detecting known threats through signatures. Unknown threats can't be detected, such as new malware families or **zero-day** attacks, which are exploits that were previously unknown.

### Anomaly-based analysis
is a detection method that identifies abnormal behavior.
There are two phases to anomaly-based analysis:
- training phase 
- detection phase
In the training phase, a baseline of normal or expected behavior must be established. Baselines are developed by collecting data that corresponds to normal system behavior.

In the detection phase, the current system activity is compared against this baseline. Activity that happens outside of the baseline gets logged, and an alert is generated.

### **Advantages**
- **Ability to detect new and evolving threats:** Unlike signature-based analysis, which uses known patterns to detect threats, anomaly-based analysis _can_ detect unknown threats.

### **Disadvantages**
- **High rate of false positives:** Any behavior that deviates from the baseline can be flagged as abnormal, including non-malicious behaviors. This leads to a high rate of false positives.
- **Pre-existing compromise:** The existence of an attacker during the training phase will include malicious behavior in the baseline. This can lead to missing a pre-existing attacker.


## Suricata
it is an open-source intrusion detection system, intrusion prevention system, and network analysis tool (network security monitoring (NSM)).

Rules
Suricata Signatures example
``` bash
# custom rules example for http connection

alert http $HOOME_NET any -> $EXTERNAL_NET ANY (MSG:"GET On wire"; flow:established; content:"GET"; sid:12345; rev:1;)
```

Action: alert
Header: http $HOOME_NET any -> $EXTERNAL_NET ANY
Rule options: (MSG:"GET On wire"; flow:established; content:"GET"; sid:12345; rev:1;)

**Note**: The terms rule and signature are synonymous. (interchangeably)

**Note:** Rule order refers to the order in which rules are evaluated by Suricata. Rules are processed in the order in which they are defined in the configuration file. However, Suricata processes rules in a different default order: pass, drop, reject, and alert. Rule order affects the final verdict of a packet especially when conflicting actions such as a drop rule and an alert rule both match on the same packet.

Suricata's configuration file is suricata.yaml, which uses the YAML file format for syntax and structure.

## Log files

There are two log files that Suricata generates when alerts are triggered:

- **eve.json**: The eve.json file is the standard Suricata log file. This file contains detailed information and metadata about the events and alerts generated by Suricata stored in JSON format. For example, events in this file contain a unique identifier called flow_id  which is used to correlate related logs or alerts to a single network flow, making it easier to analyze network traffic. The eve.json file is used for more detailed analysis and is considered to be a better file format for log parsing and SIEM log ingestion.
    
- **fast.log**: The fast.log file is used to record minimal alert information including basic IP address and port details about the network traffic. The fast.log file is used for basic logging and alerting and is considered a legacy file format and is not suitable for incident response or threat hunting tasks.
    

The main difference between the eve.json file and the fast.log file is the level of detail that is recorded in each. The fast.log file records basic information, whereas the eve.json file contains additional verbose information.

# SIEM
Security Information and Event Management
An application that collects and analyzes log data to monitor critical activities in an organization.

By collecting, analyzing, and reporting on security data from multiple sources.
- **Collect and process**: the handling of an enormous amount of data generated by devices and systems from all over an environment.
- **Normalize**: that makes raw data easy to read and analyze.
- **Index**: step that sorts data so it can be easily searched and accessed

Examples:
- Splunk: Is data analysis platform.
- Chronicle: is google cloud SIEM which stores security data for search, analysis, and visualization.


### Log forwarders
There are many ways SIEM tools can ingest log data. For instance, you can manually upload data or use software to help collect data for log ingestion. Manually uploading data may be inefficient and time-consuming because networks can contain thousands of systems and devices.

Log forwarders are software that automate the process of collecting and sending log data. Some operating systems have native log forwarders.